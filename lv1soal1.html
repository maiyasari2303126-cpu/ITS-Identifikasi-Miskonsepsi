<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ITS ‚Äì Grafik Kunjungan Kantin</title>

  <!-- Tailwind & Chart.js -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-[#F2F4FF] min-h-screen flex items-center justify-center p-4">

  <!-- KARTU UTAMA -->
  <div class="max-w-3xl w-full bg-white rounded-3xl shadow-2xl overflow-hidden">

    <!-- HEADER gradient BIRU UNGU -->
    <div class="p-6 md:p-8 bg-gradient-to-r from-indigo-500 to-sky-500 text-white">
      <h1 class="text-3xl md:text-4xl font-extrabold mb-1">
        Eksperimen Grafik dan Data
      </h1>
      <p class="text-lg font-light">
        Mari analisis data pengunjung kantin sekolah!
      </p>
    </div>

    <!-- ISI -->
    <div class="p-6 md:p-8 space-y-8">

      <!-- KARTU GRAFIK -->
      <div class="bg-white rounded-2xl border-4 border-sky-200 shadow-inner p-5 md:p-8">
        <h2 class="text-xl font-bold text-gray-700 mb-4 text-center">
          Diagram Batang Pengunjung Kantin
        </h2>
        <div class="h-64 md:h-80">
          <canvas id="chartKantin"></canvas>
        </div>
      </div>

      <!-- KOTAK SOAL -->
      <div class="p-6 bg-orange-50 border-2 border-orange-300 rounded-2xl shadow-lg">
        <p class="text-xl font-extrabold text-indigo-700 mb-4 flex items-center gap-2">
          Nomor 1
        </p>

        <p class="text-lg text-gray-800 mb-6">
          Berdasarkan grafik di atas, pada hari apa jumlah pengunjung kantin paling banyak?
        </p>

        <div class="space-y-3 text-gray-800">
          <label class="flex items-center cursor-pointer p-3 rounded-lg bg-white shadow hover:bg-orange-100 transition">
            <input type="radio" name="jawaban" value="A" class="h-4 w-4 mr-3 text-indigo-600">
            A. Senin
          </label>

          <label class="flex items-center cursor-pointer p-3 rounded-lg bg-white shadow hover:bg-orange-100 transition">
            <input type="radio" name="jawaban" value="B" class="h-4 w-4 mr-3 text-indigo-600">
            B. Selasa
          </label>

          <label class="flex items-center cursor-pointer p-3 rounded-lg bg-white shadow hover:bg-orange-100 transition">
            <input type="radio" name="jawaban" value="C" class="h-4 w-4 mr-3 text-indigo-600">
            C. Rabu
          </label>

          <label class="flex items-center cursor-pointer p-3 rounded-lg bg-white shadow hover:bg-orange-100 transition">
            <input type="radio" name="jawaban" value="D" class="h-4 w-4 mr-3 text-indigo-600">
            D. Kamis
          </label>
        </div>

        <button onclick="cekJawaban()"
          class="mt-6 w-full px-8 py-3 bg-indigo-600 text-white font-bold rounded-xl shadow-md
                 transition transform hover:scale-[1.02] hover:bg-indigo-700 active:scale-[0.98]">
          SUBMIT
        </button>

        <div id="feedback"
          class="mt-6 p-4 rounded-xl text-md font-semibold border hidden transition-all duration-300"></div>

        <div id="nextBox" style="margin-top:10px; display:none;">
          <button onclick="keNomor2()"
            class="mt-3 w-full px-6 py-3 bg-orange-500 text-white font-bold rounded-xl shadow
                   hover:bg-orange-600">
             Nomor 2 
          </button>
        </div>
      </div>
    </div>
  </div>

<script>
// ===================== GRAFIK =====================
const ctx = document.getElementById('chartKantin');
new Chart(ctx, {
  type: 'bar',
  data: {
    labels: ['Senin', 'Selasa', 'Rabu', 'Kamis'],
    datasets: [{
      label: 'Jumlah Pengunjung',
      data: [40, 55, 30, 35],
      backgroundColor: ['#93C5FD','#60A5FA','#3B82F6','#2563EB']
    }]
  },
  options: {
    responsive: true,
    maintainAspectRatio: false,
    scales: {
      y: {
        beginAtZero: true,
        title: { display: true, text: 'Jumlah Pengunjung' }
      }
    }
  }
});

// ===================== MISKONSEPSI =====================
const kunciJawaban = "B";
const miskonsepsiMap = {
  "A": "Kamu hanya melihat awal grafik. Bandingkan semua batang.",
  "C": "Lihat tinggi setiap batang, itu yang menentukan jumlah terbanyak.",
  "D": "Bandingkan lagi tinggi batang, Selasa paling tinggi."
};

// ===================== REKAP NILAI =====================
function simpanJawabanLevel1({ soalId, benar, jawaban, kunci }) {
  const KEY = "rekap_level1";
  let rekap = sessionStorage.getItem(KEY);

  rekap = rekap ? JSON.parse(rekap) : {
    totalBenar: 0,
    totalSalah: 0,
    daftar: []
  };

  const waktu = new Date().toLocaleString();
  rekap.daftar.push({ soalId, benar, jawaban, kunci, waktu });

  if (benar) rekap.totalBenar++;
  else rekap.totalSalah++;

  sessionStorage.setItem(KEY, JSON.stringify(rekap));
}


// ===================== BAYESIAN NETWORK GLOBAL =====================
// Tambah node sampai M9 (supaya konsisten dengan soal 1‚Äì10)
function initBN() {
  let BN = JSON.parse(sessionStorage.getItem("BN_Data"));

  if (!BN) {
    BN = {
      prior: {
        M1: 0.4,
        M2: 0.4,
        M3: 0.4,
        M4: 0.4,
        M5: 0.4,
        M6: 0.4,
        M7: 0.4, // Soal 7: miskonsepsi sudut‚Äìpersentase cupcake
        M8: 0.4,
        M9: 0.4
      },
      likelihood: {
        M1: { benar: 0.3, salah: 0.7 },
        M2: { benar: 0.3, salah: 0.7 },
        M3: { benar: 0.3, salah: 0.7 },
        M4: { benar: 0.3, salah: 0.7 },
        M5: { benar: 0.3, salah: 0.7 },
        M6: { benar: 0.3, salah: 0.7 },
        M7: { benar: 0.3, salah: 0.7 },
        M8: { benar: 0.3, salah: 0.7 },
        M9: { benar: 0.3, salah: 0.7 }
      },
      posterior: {}
    };
  }

  return BN;
}

// Update BN berdasarkan jawaban
function updateBN(node, benar) {
  let BN = initBN();

  const prior   = BN.prior[node];
  const like    = benar ? BN.likelihood[node].benar : BN.likelihood[node].salah;
  const likeNot = 1 - like;

  const num = prior * like;
  const den = num + (1 - prior) * likeNot;
  const posterior = den === 0 ? prior : num / den;

  BN.prior[node]     = Number(posterior.toFixed(4));
  BN.posterior[node] = BN.prior[node];

 sessionStorage.setItem("BN_Data", JSON.stringify(BN));
}


// ===================== CEK JAWABAN =====================
function cekJawaban() {
  const pilihan = document.querySelector('input[name="jawaban"]:checked');
  const fb = document.getElementById("feedback");

  if (!pilihan) {
    fb.className = "mt-6 p-4 rounded-xl border border-orange-500 bg-orange-100 text-orange-800";
    fb.innerHTML = "‚ùó Silakan pilih jawaban.";
    fb.classList.remove("hidden");
    return;
  }

  const answer = pilihan.value;
  const benar = answer === kunciJawaban;

  fb.classList.remove("hidden");
  fb.className =
    benar
    ? "mt-6 p-4 rounded-xl border border-green-500 bg-green-100 text-green-800"
    : "mt-6 p-4 rounded-xl border border-red-500 bg-red-100 text-red-800";

  fb.innerHTML = benar
    ? "‚úîÔ∏è Jawaban benar! Selasa adalah pengunjung terbanyak."
    : "‚ùå Jawaban salah. <br>Miskonsepsi: <b>" + miskonsepsiMap[answer] + "</b>";

  document.querySelectorAll('input[name=\"jawaban\"]').forEach(r => r.disabled = true);

    // simpan nilai
  simpanJawabanLevel1({
    soalId: "Nomor1",
    benar,
    jawaban: answer,
    kunci: kunciJawaban
  });

  // üî• update BN untuk M1
  updateBN("M1", benar);

  document.getElementById("nextBox").style.display = "block";
}


function keNomor2() {
  window.location.href = "lv1soal2.html";
}
</script>

</body>
</html>
