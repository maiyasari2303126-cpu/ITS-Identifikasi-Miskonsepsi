<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kuis HOTS Statistika SMP ‚Äì Diagram Batang Klub</title>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>

<body class="bg-blue-50 min-h-screen flex items-center justify-center p-4">

<div class="max-w-4xl w-full bg-white rounded-3xl shadow-2xl overflow-hidden">

    <!-- HEADER -->
    <div class="p-6 md:p-8 bg-gradient-to-r from-teal-500 to-sky-600 text-white flex items-center justify-between">
        <div>
            <h1 class="text-3xl md:text-4xl font-black mb-1">Analisis Minat Siswa</h1>
            <p class="text-lg font-light">Tantangan HOTS Mengubah Data Campuran ke Diagram Batang</p>
        </div>
        <div class="text-5xl">üìäüí°</div>
    </div>

    <!-- KONTEN -->
    <div class="p-6 md:p-10 flex flex-col gap-8">

        <div class="flex flex-col lg:flex-row gap-8">

            <!-- GRAFIK -->
            <div class="lg:w-1/2 w-full flex flex-col items-center">
                <h2 class="text-xl font-bold text-gray-700 mb-4 text-center border-b pb-2 w-full">
                    Visualisasi Jumlah Anggota Klub
                </h2>
                <div class="w-full h-64 md:h-80 flex items-center justify-center bg-gray-50 rounded-xl p-4 shadow-inner">
                    <canvas id="barChartKlub"></canvas>
                </div>
                <p class="mt-2 text-sm text-gray-600 font-semibold text-center">
                    Sumbu Y: Jumlah Siswa | Sumbu X: Nama Klub
                </p>
            </div>

            <!-- TABEL -->
            <div class="lg:w-1/2 w-full">
                <div class="p-4 bg-yellow-50 border-2 border-yellow-400 rounded-xl shadow-md h-full">
                    <p class="text-lg font-bold text-sky-700 mb-2">
                        Tabel Data Anggota Klub (Total Siswa = 300)
                    </p>
                    <table class="w-full text-sm text-gray-700">
                        <thead class="bg-yellow-200">
                            <tr>
                                <th class="p-2 border border-yellow-300">Klub</th>
                                <th class="p-2 border border-yellow-300">Jumlah Anggota</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td class="p-2 border">Sains (A)</td><td class="p-2 border">90 siswa</td></tr>
                            <tr><td class="p-2 border">Robotik (B)</td><td class="p-2 border">30 persen dari total</td></tr>
                            <tr><td class="p-2 border">Musik (D)</td><td class="p-2 border">60 siswa</td></tr>
                            <tr class="font-bold text-red-600">
                                <td class="p-2 border">Basket (C)</td><td class="p-2 border">Sisanya</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

        </div>

        <!-- PERTANYAAN -->
        <div>
            <div class="p-6 bg-indigo-50 border-2 border-indigo-400 rounded-xl shadow-lg">
                <p class="text-xl font-extrabold text-indigo-700 mb-4">Nomor 8</p>
                
                <p class="text-lg text-gray-800 mb-6 font-medium">
                    Setelah berhasil mengubah data di atas ke dalam diagram batang, perhatikan klub dengan jumlah anggota paling sedikit.
                    <br><br>
                    Jika sekolah ingin klub tersebut (paling sedikit) mencapai 30 persen dari Total Siswa, dan semua anggota baru tersebut HARUS berasal dari klub dengan anggota paling banyak, berapa jumlah siswa yang harus berpindah dari klub terbanyak ke klub tersedikit?
                </p>

                <!-- PILIHAN JAWABAN -->
                <div class="space-y-4 text-gray-800">
                    <label class="flex items-center p-3 bg-white rounded-lg shadow cursor-pointer hover:bg-indigo-100">
                        <input type="radio" name="jawaban" value="A" class="h-5 w-5 mr-4"> A. 15 siswa
                    </label>

                    <label class="flex items-center p-3 bg-white rounded-lg shadow cursor-pointer hover:bg-indigo-100">
                        <input type="radio" name="jawaban" value="B" class="h-5 w-5 mr-4"> B. 20 siswa
                    </label>

                    <label class="flex items-center p-3 bg-white rounded-lg shadow cursor-pointer hover:bg-indigo-100">
                        <input type="radio" name="jawaban" value="C" class="h-5 w-5 mr-4"> C. 30 siswa
                    </label>

                    <label class="flex items-center p-3 bg-white rounded-lg shadow cursor-pointer hover:bg-indigo-100">
                        <input type="radio" name="jawaban" value="D" class="h-5 w-5 mr-4"> D. 40 siswa
                    </label>
                </div>

                <button onclick="cekJawaban()" class="mt-8 w-full px-8 py-3 bg-teal-600 text-white font-bold rounded-xl shadow hover:bg-teal-700">
                   SUBMIT
                </button>

                <div id="feedback" class="mt-6 p-4 rounded-xl font-semibold border hidden"></div>

                <div id="nextBox" class="mt-4 hidden">
                    <button onclick="keNomor9()" class="w-full px-6 py-3 bg-pink-500 text-white font-bold rounded-xl hover:bg-pink-600">
                        Nomor 9 
                    </button>
                </div>

            </div>
        </div>

    </div>
</div>

<script>
// ====================== GRAFIK ===========================
window.onload = function() {
    const totalSiswa = 300;
    const jmlSains = 90;
    const jmlRobotik = 0.30 * totalSiswa; // 90
    const jmlMusik = 60;
    const subtotal = jmlSains + jmlRobotik + jmlMusik;
    const jmlBasket = totalSiswa - subtotal; // 60

    const ctx = document.getElementById('barChartKlub').getContext('2d');

    new Chart(ctx, {
        type: 'bar',
        data: {
            labels: ['Sains (A)', 'Robotik (B)', 'Basket (C)', 'Musik (D)'],
            datasets: [{
                label: 'Jumlah Siswa',
                data: [jmlSains, jmlRobotik, jmlBasket, jmlMusik],
                backgroundColor: [
                    'rgba(255, 99, 132, 0.8)',
                    'rgba(54, 162, 235, 0.8)',
                    'rgba(255, 206, 86, 0.8)',
                    'rgba(75, 192, 192, 0.8)'
                ],
                borderWidth: 1.5
            }]
        },
        options: { responsive: true, maintainAspectRatio: false }
    });
};

// ====================== LOGIKA JAWABAN ======================
const kunciJawaban = "C";

const miskonsepsiMap = {
    A: "Salah membagi selisih, sehingga hanya mendapat 15 siswa.",
    B: "Salah menghitung target 30% atau jumlah anggota Basket.",
    D: "Menganggap total 400 atau salah menentukan klub terbesar."
};

function simpanJawabanLevel1({ soalId, benar, jawaban, kunci }) {
  const KEY = "rekap_level1";
  let data = sessionStorage.getItem(KEY);

  // inisialisasi struktur rekap
  data = data ? JSON.parse(data) : {
    totalBenar: 0,
    totalSalah: 0,
    daftar: []
  };

  // buat waktu sekarang
  const waktu = new Date().toLocaleString();

  // simpan satu record lengkap
  data.daftar.push({
    soalId,
    benar,
    jawaban,
    kunci,
    waktu
  });

  if (benar) data.totalBenar++;
  else data.totalSalah++;

  sessionStorage.setItem(KEY, JSON.stringify(data));
}


// ===================== BAYESIAN NETWORK GLOBAL =====================
// Tambah node sampai M9 (supaya konsisten dengan soal 1‚Äì10)
function initBN() {
  let BN = JSON.parse(sessionStorage.getItem("BN_Data"));

  if (!BN) {
    BN = {
      prior: {
        M1: 0.4,
        M2: 0.4,
        M3: 0.4,
        M4: 0.4,
        M5: 0.4,
        M6: 0.4,
        M7: 0.4, // Soal 7: miskonsepsi sudut‚Äìpersentase cupcake
        M8: 0.4,
        M9: 0.4
      },
      likelihood: {
        M1: { benar: 0.3, salah: 0.7 },
        M2: { benar: 0.3, salah: 0.7 },
        M3: { benar: 0.3, salah: 0.7 },
        M4: { benar: 0.3, salah: 0.7 },
        M5: { benar: 0.3, salah: 0.7 },
        M6: { benar: 0.3, salah: 0.7 },
        M7: { benar: 0.3, salah: 0.7 },
        M8: { benar: 0.3, salah: 0.7 },
        M9: { benar: 0.3, salah: 0.7 }
      },
      posterior: {}
    };
  }

  return BN;
}

// Update BN berdasarkan jawaban
function updateBN(node, benar) {
  let BN = initBN();

  const prior   = BN.prior[node];
  const like    = benar ? BN.likelihood[node].benar : BN.likelihood[node].salah;
  const likeNot = 1 - like;

  const num = prior * like;
  const den = num + (1 - prior) * likeNot;
  const posterior = den === 0 ? prior : num / den;

  BN.prior[node]     = Number(posterior.toFixed(4));
  BN.posterior[node] = BN.prior[node];

  sessionStorage.setItem("BN_Data", JSON.stringify(BN));
}

function cekJawaban() {
    const pilihan = document.querySelector('input[name="jawaban"]:checked');
    const fb = document.getElementById("feedback");

    fb.classList.remove("hidden");

    if (!pilihan) {
        fb.className = "mt-6 p-4 rounded-xl font-semibold border bg-yellow-100 border-yellow-500 text-yellow-800";
        fb.innerHTML = "‚ùó Pilih jawaban dulu.";
        return;
    }

    const answer = pilihan.value;
    const benar = (answer === kunciJawaban);

    if (benar) {
        fb.className = "mt-6 p-4 rounded-xl font-semibold border bg-green-100 border-green-500 text-green-800";
        fb.innerHTML =
            "‚úî <b>BENAR!</b><br><br>" +
            "Target 30% √ó 300 = 90 siswa.<br>" +
            "Basket saat ini 60 siswa.<br>" +
            "Perlu tambahan = 30 siswa.";
    } else {
        fb.className = "mt-6 p-4 rounded-xl font-semibold border bg-red-100 border-red-500 text-red-800";
        fb.innerHTML =
            "‚ùå <b>Salah.</b><br><i>" + miskonsepsiMap[answer] + "</i>";
    }

    // simpan nilai
simpanJawabanLevel1({
  soalId: "Nomor8",
  benar,
  jawaban: answer,
  kunci: kunciJawaban
});

// üî• update BN untuk M1
updateBN("M8", benar);

    document.getElementById("nextBox").classList.remove("hidden");
}

function keNomor9() {
    window.location.href = "lv1soal9.html";
}
</script>

</body>
</html>
